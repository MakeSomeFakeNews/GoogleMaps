# Google Maps 中国瓦片地图下载器

高性能、低内存占用的Google Maps卫星地图瓦片下载工具，支持下载全中国的瓦片地图。

## 特性

- ✅ 支持自定义缩放等级 (1-18)
- ✅ 高性能并发下载 (可配置并发数量)
- ✅ 低内存占用设计
- ✅ 断点续传功能
- ✅ 中国边界精确计算
- ✅ 进度跟踪和统计
- ✅ 自动重试机制

## 快速开始

### 1. 编译项目

```bash
mvn clean compile
```

### 2. 运行下载器

```bash
mvn exec:java -Dexec.mainClass="com.runcam.maps.GoogleMapApplication"
```

### 3. 交互式配置

程序会提示您输入以下参数：
- **输出目录**: 瓦片文件保存路径 (默认: ./tiles)
- **最小缩放等级**: 1-18 (默认: 1)
- **最大缩放等级**: 1-18 (默认: 12)
- **并发下载数**: 同时下载的线程数 (默认: 10)

## 配置示例

### 下载等级1-8的中国地图瓦片

```bash
输出目录: ./china_tiles
最小缩放等级: 1
最大缩放等级: 8
并发下载数: 20
```

### 高级配置

创建配置文件 `config.json`:

```json
{
  "outputDirectory": "./china_satellite",
  "minZoom": 1,
  "maxZoom": 16,
  "maxConcurrentDownloads": 15,
  "timeoutSeconds": 30
}
```

## 文件结构

```
tiles/
├── 1/
│   ├── 0/
│   │   ├── 0.jpg
│   │   └── 1.jpg
│   └── 1/
│       ├── 0.jpg
│       └── 1.jpg
├── 2/
│   ├── 0/
│   │   ├── 0.jpg
│   │   ├── 1.jpg
│   │   └── 2.jpg
│   └── 1/
│       ├── 0.jpg
│       └── 1.jpg
└── ...
```

## 技术特点

### 性能优化
- **连接池**: 使用Apache HttpClient连接池
- **并发控制**: 可配置的线程池大小
- **内存管理**: 流式处理，避免内存溢出
- **断点续传**: 支持中断后从断点继续下载

### 准确性
- **中国边界**: 精确计算中国地理边界范围
- **墨卡托投影**: 使用标准Web墨卡托投影算法
- **坐标转换**: 精确的经纬度到瓦片坐标转换

### 可靠性
- **错误重试**: 自动重试失败的下载
- **进度跟踪**: 实时显示下载进度
- **文件验证**: 跳过已下载的文件
- **优雅关闭**: 支持Ctrl+C安全退出

## 预计下载量

| 缩放等级 | 中国范围瓦片数 | 估计存储空间 |
|----------|----------------|--------------|
| 1        | 4              | ~0.2 MB      |
| 2        | 12             | ~0.6 MB      |
| 3        | 40             | ~2 MB        |
| 4        | 132            | ~6.6 MB      |
| 5        | 465            | ~23 MB       |
| 6        | 1,596          | ~80 MB       |
| 7        | 5,984          | ~300 MB      |
| 8        | 22,176         | ~1.1 GB      |
| 9        | 85,989         | ~4.3 GB      |
| 10       | 336,388        | ~16.8 GB     |
| 11       | 1,329,968      | ~66.5 GB     |
| 12       | 5,291,712      | ~264.6 GB    |

## 使用建议

1. **存储空间**: 确保有足够的磁盘空间
2. **网络带宽**: 建议使用高速稳定网络
3. **并发设置**: 根据网络情况调整并发数
4. **分批下载**: 建议分批下载，避免一次性下载过多等级

## 故障排除

### 下载中断
程序支持断点续传，重新运行会自动跳过已下载的文件。

### 网络问题
- 检查网络连接
- 调整timeout设置
- 降低并发数

### 存储问题
- 确保磁盘空间充足
- 检查文件权限
- 考虑分批下载

## 开发说明

项目使用Java 17 + Maven构建，主要依赖：
- Apache HttpClient 5: HTTP客户端
- Jackson: JSON处理
- SLF4J: 日志框架

## 许可证

本项目仅供学习和研究使用，请遵守Google Maps的使用条款。